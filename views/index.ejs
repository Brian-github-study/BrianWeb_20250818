<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>部落格首頁</title>
  <link rel="stylesheet" href="/style.css">
  <link rel="stylesheet" href="/tiptapstyle.css">
</head>
<body>

<%- include ("partials/nav") %>

  <!-- <hr style="margin: 0.5rem;"> -->
  <section>
    <h2>文章列表</h2>
    <div>
      <ul id="posts-container" class="cards">
      <!-- JS 會動態生成文章卡片 -->
      </ul>
    </div>
    
  </section>

  <script>
    // 文章
fetch('/post/api/posts')
  .then(res => res.json())
  .then(data => {
    const container = document.getElementById('posts-container');
    const posts = data.posts;
    posts.forEach(post => {
      const li = document.createElement('li');
      li.innerHTML = `
        <div class="excerpt"><a href="/post/posts/${post._id}">${post.content}</a></div>
        <small>${new Date(post.createdAt).toLocaleString()}</small>
        <div><a href="/post/postedit/${post._id}">Edit</a></div>
        <div><a href="/post/postdelete/${post._id}">Delete</a></div>
      `;
      container.appendChild(li);
    });
  });
  </script>
</body>
</html>
